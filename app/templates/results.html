{% extends "base.html" %}
{% block content %}
<div class="container mt-4 d-flex justify-content-center">
  <div class="card shadow-lg w-75 text-center p-4">
    {% with messages = get_flashed_messages(with_categories=true) %}
      {% if messages %}
        <div class="mb-3">
          {% for category, msg in messages %}
            <div class="alert alert-{{ category if category else 'info' }} alert-dismissible fade show" role="alert">
              {{ msg }}
              <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
            </div>
          {% endfor %}
        </div>
      {% endif %}
    {% endwith %}

    <h3>
      {% if is_correct %}
        <span class="text-success">‚úÖ Correct!</span>
      {% else %}
        <span class="text-danger">‚ùå Incorrect</span>
      {% endif %}
    </h3>

    <p><strong>Your answer:</strong> {{ user_answer or "‚Äî" }}</p>
    <p><strong>Correct answer:</strong> {{ correct_answer }}</p>

    {% if next_index < total %}
      <a href="{{ url_for('tests_bp.run', index=next_index) }}" class="btn btn-primary mt-3" id="next-btn">Next</a>
      <div class="mt-2 text-muted small">üí° Press Enter to go to the next question</div>
    {% else %}
      <a href="{{ url_for('tests_bp.finish') }}" class="btn btn-success mt-3" id="finish-btn">Finish</a>
      <div class="mt-2 text-muted small">üí° Press Enter to finish the quiz</div>
    {% endif %}
  </div>
</div>

<script>
// Handle Enter key for quick transition to next question
document.addEventListener('keydown', function(event) {
  if (event.key === 'Enter') {
    const nextBtn = document.getElementById('next-btn');
    const finishBtn = document.getElementById('finish-btn');
    
    if (nextBtn) {
      nextBtn.click();
    } else if (finishBtn) {
      finishBtn.click();
    }
  }
});

// Autofocus on button for better UX
window.addEventListener('load', function() {
  const nextBtn = document.getElementById('next-btn');
  const finishBtn = document.getElementById('finish-btn');
  
  if (nextBtn) {
    nextBtn.focus();
  } else if (finishBtn) {
    finishBtn.focus();
  }
});
</script>
{% endblock %}


