{% extends "base.html" %}
{% block content %}
<div class="container mt-4 d-flex justify-content-center">
  <div class="card shadow-lg w-75 text-center p-4">
    {% with messages = get_flashed_messages(with_categories=true) %}
      {% if messages %}
        <div class="mb-3">
          {% for category, msg in messages %}
            <div class="alert alert-{{ category if category else 'info' }} alert-dismissible fade show" role="alert">
              {{ msg }}
              <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
            </div>
          {% endfor %}
        </div>
      {% endif %}
    {% endwith %}

    <h3>
      {% if is_correct %}
        <span class="text-success">‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–æ!</span>
      {% else %}
        <span class="text-danger">‚ùå –ù–µ–≤–µ—Ä–Ω–æ</span>
      {% endif %}
    </h3>

    <p><strong>–í–∞—à –æ—Ç–≤–µ—Ç:</strong> {{ user_answer or "‚Äî" }}</p>
    <p><strong>–ü—Ä–∞–≤–∏–ª—å–Ω—ã–π –æ—Ç–≤–µ—Ç:</strong> {{ correct_answer }}</p>

    {% if next_index < total %}
      <a href="{{ url_for('tests_bp.run', index=next_index) }}" class="btn btn-primary mt-3" id="next-btn">–°–ª–µ–¥—É—é—â–µ–µ</a>
      <div class="mt-2 text-muted small">üí° –ù–∞–∂–º–∏—Ç–µ Enter –¥–ª—è –ø–µ—Ä–µ—Ö–æ–¥–∞ –∫ —Å–ª–µ–¥—É—é—â–µ–º—É –≤–æ–ø—Ä–æ—Å—É</div>
    {% else %}
      <a href="{{ url_for('tests_bp.finish') }}" class="btn btn-success mt-3" id="finish-btn">–ó–∞–≤–µ—Ä—à–∏—Ç—å</a>
      <div class="mt-2 text-muted small">üí° –ù–∞–∂–º–∏—Ç–µ Enter –¥–ª—è –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è —Ç–µ—Å—Ç–∞</div>
    {% endif %}
  </div>
</div>

<script>
// –û–±—Ä–∞–±–æ—Ç–∫–∞ –∫–ª–∞–≤–∏—à–∏ Enter –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –ø–µ—Ä–µ—Ö–æ–¥–∞ –∫ —Å–ª–µ–¥—É—é—â–µ–º—É –≤–æ–ø—Ä–æ—Å—É
document.addEventListener('keydown', function(event) {
  if (event.key === 'Enter') {
    const nextBtn = document.getElementById('next-btn');
    const finishBtn = document.getElementById('finish-btn');
    
    if (nextBtn) {
      nextBtn.click();
    } else if (finishBtn) {
      finishBtn.click();
    }
  }
});

// –ê–≤—Ç–æ—Ñ–æ–∫—É—Å –Ω–∞ –∫–Ω–æ–ø–∫—É –¥–ª—è –ª—É—á—à–µ–≥–æ UX
window.addEventListener('load', function() {
  const nextBtn = document.getElementById('next-btn');
  const finishBtn = document.getElementById('finish-btn');
  
  if (nextBtn) {
    nextBtn.focus();
  } else if (finishBtn) {
    finishBtn.focus();
  }
});
</script>
{% endblock %}


